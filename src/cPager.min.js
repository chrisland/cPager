/* cPager v0.3.2 */
function cPager(t){"use strict";if(this._page,this._open=0,this._lastopen=0,this._history=[],this._pageClass="",this._bodyClass="",this.animate=!1,this._opt={handler:"pageBtn",tmplPath:"tmpl",offButton:"pageBtnOffline",container:"page",start:!1,startTask:!1,startContent:!1,startParam:{history:!0},preCache:[],animate:!1,direction:"left",duration:2},t)for(var e in t)t.hasOwnProperty(e)&&(this._opt[e]=t[e]);if(this._opt.controller&&this._opt.controller.length>0)for(var e=0;e<this._opt.controller.length;e++)this._h.loadScript(this._opt.controller[e]);if(this.ajaxCache={},this._opt.preCache.length>0&&this._h.cache(this,this._opt.preCache),this._page=document.getElementById(this._opt.container),!this._page)throw new Error("missing main container #"+this._opt.container);return this._pageClass=this._page.className||"",this._bodyClass=document.body.className||"",this._lastopen?this["switch"](this._lastopen):this._opt.start&&this["switch"](this._opt.start,this._opt.startTask,this._opt.startContent,this._opt.startParam),this}cPager.prototype["switch"]=function(t,e,a,s){var i=null;if(s&&s.event&&(i=s.event),"back"==e){var n=parseInt(a)+1||2,r=this.getHistory(),o=r[r.length-n];if(!o)return!1;if(!o.id)return!1;i=i||o.param.event,t=o.id,e=o.task,a=o.content,s=s||o.param,this.removeHistory(n)}return this["switch"].task=this._h.getTask(i,e,a,t,this,s),!(e&&!this["switch"].task)&&(t?this._h.loadPage(this,"./"+this._opt.tmplPath+"/"+t+".tpl",t,e,a,s):this["switch"].task&&"function"==typeof this["switch"].task&&this["switch"].task(),this)},cPager.prototype.events=function(){for(var t=this,e=function(e){if(this.classList.contains(t._opt.offButton))return!1;if(t.animate)return!1;var a=this.getAttribute("data-page"),s=this.getAttribute("data-task"),i=this.getAttribute("data-content"),n=this.getAttribute("data-container")||!1,r=this.getAttribute("data-animate")||t._opt.animate,o=this.getAttribute("data-duration")||!1,c=this.getAttribute("data-direction")||!1,h=this.getAttribute("data-force")||!1,p=this.getAttribute("data-history")||!0;if(a||s){if(t._open==a&&!h)return!1;var l={event:e,history:p,animate:r,duration:o,direction:c,container:n||!1};t["switch"](a,s,i,l)}},a=document.getElementsByClassName(this._opt.handler),s=0;s<a.length;s++)a[s].style.curser="pointer",a[s].onclick||(a[s].onclick=e);return!0},cPager.prototype.getHistory=function(){return!!this._history&&this._history},cPager.prototype.removeHistory=function(t){return t&&!isNaN(t)&&this._history.length>0&&(this._history=this._history.slice(0,this._history.length-t)),!0},cPager.prototype.addHistory=function(t,e,a,s){var i={id:t,task:e,content:a,param:s};return this._history.push(i),!0},cPager.prototype.addTask=function(t,e){if(!t||"string"!=typeof t||!e||"object"!=typeof e)return!1;this._opt.tasks[t]&&"object"==typeof this._opt.tasks[t]||(this._opt.tasks[t]={});for(var a in e)e.hasOwnProperty(a)&&(this._opt.tasks[t][a]=e[a]);return!0},cPager.prototype._h={getTask:function(t,e,a,s,i,n){if(i._opt.tasks&&e){var r=e.split(".");if(r.length>0){var o=!1,c=!1;return r[0]&&r[1]&&i._opt.tasks[r[0]]&&i._opt.tasks[r[0]][r[1]]?(o=i._opt.tasks[r[0]][r[1]],c=i._opt.tasks[r[0]]):r[0]&&i._opt.tasks[r[0]]&&(o=i._opt.tasks[r[0]],c=i._opt.tasks),o&&"function"==typeof o?o(s,a,t,i._page,c):(console.error("cPager Error: missing task function"),!1)}}return!1},successPage:function(t,e,a,s,i,n){t["switch"].task&&"function"==typeof t["switch"].task&&(t["switch"].afterAnimate=t["switch"].task(n||t._page)),i.animate||t.events(),i&&"false"!=String(i.history)&&t.addHistory(e,a,s,i)},successAnimate:function(t,e,a,s,i,n){t.animate=!1,t["switch"].task&&t["switch"].afterAnimate&&"function"==typeof t["switch"].afterAnimate&&t["switch"].afterAnimate(),t.events()},appendPage:function(t,e,a,s,i,n){var r=i._page;if(n&&n.container&&(r=document.getElementById(n.container),!r))throw new Error("missing container #"+this._opt.container);var o=e.replace(/\//gi,"-");document.body.className+=" cPager-body-"+o,n&&n.animate?this.animatePage(i,e,a,s,n,r,o,t):(r.innerHTML=t,r.className=i._pageClass+" "||"",r.className+="cPager-"+o,i._lastopen=i._open,i._open=e,this.successPage(i,e,a,s,n,r))},animatePage:function(t,e,a,s,i,n,r,o){t.animate=!0,i.duration||(i.duration=t._opt.duration),i.direction||(i.direction=t._opt.direction),n.id=t._opt.container+"Temp",n.style.width=n.clientWidth+"px",n.style.height=n.clientHeight+"px",n.style.position="fixed",n.style.transform="translate3d(0,0,0)",n.style.transition="transform "+i.duration+"s "+i.animate;var c=document.createElement("div");switch(c.id=t._opt.container,c.className=t._pageClass+" "||"",c.className+="cPager-"+r,c.innerHTML=o,c.style.position="fixed",c.style.width=n.clientWidth+"px",c.style.height=n.clientHeight+"px",i.direction){case"left":default:c.style.transform="translate3d("+n.style.width+",0,0)";break;case"right":c.style.transform="translate3d(-"+n.style.width+",0,0)";break;case"top":c.style.transform="translate3d(0,"+n.style.height+",0)";break;case"bottom":c.style.transform="translate3d(0,-"+n.style.height+",0)"}c.style.transition="transform "+i.duration+"s "+i.animate,document.body.insertBefore(c,n.nextSibling),setTimeout(function(){switch(i.direction){case"left":default:n.style.transform="translate3d(-"+n.style.width+",0,0)";break;case"right":n.style.transform="translate3d("+n.style.width+",0,0)";break;case"top":n.style.transform="translate3d(0,-"+n.style.height+",0)";break;case"bottom":n.style.transform="translate3d(0,"+n.style.height+",0)"}c.style.transform="translate3d(0,0,0)",t._lastopen=t._open,t._open=e,t._page=c,t._h.successPage(t,e,a,s,i,c)},100),setTimeout(function(){n.remove(),t._h.successAnimate(t,e,a,s,i,c),n.style.transition="",c.style.transition="",document.body.className=t._bodyClass+" "||"",document.body.className+="cPager-body-"+r},1e3*i.duration+100)},loadPage:function(t,e,a,s,i,n){var r=this;t.ajaxCache[e]?r.appendPage(t.ajaxCache[e],a,s,i,t,n):this.sendRequest(e,function(o){t.ajaxCache[e]=o,r.appendPage(o,a,s,i,t,n)})},cache:function(t,e){for(var a=0;a<e.length;a++){var s="./"+t._opt.tmplPath+"/"+e[a]+".tpl";this.sendRequest(s,function(e,a){t.ajaxCache[a]=e})}},sendRequest:function(t,e,a){function s(){for(var t=!1,e=0;e<i.length;e++){try{t=i[e]()}catch(a){continue}break}return t}if(window.jQuery)jQuery.ajax({url:t,dataType:"html",cache:!1}).done(function(a){e(a,t)}).fail(function(t){console.log("error",t)});else{var i=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],n=s();if(!n)return;var r=a?"POST":"GET";if(n.open(r,t,!0),n.setRequestHeader("User-Agent","XMLHTTP/1.0"),a&&n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.onreadystatechange=function(){4==n.readyState&&(200!=n.status&&304!=n.status||e(n.responseText,t))},4==n.readyState)return;n.send(a)}},loadScript:function(t,e){var a=document.getElementsByTagName("head")[0],s=document.createElement("script");s.type="text/javascript",s.src=t+".js",s.onreadystatechange=e,s.onload=e,a.appendChild(s)}};
